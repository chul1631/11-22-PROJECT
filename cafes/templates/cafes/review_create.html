{% extends 'base.html' %} {% load django_bootstrap5 %} {% load static %} {%block content %} {% bootstrap_javascript %}
<h1>카페이름은 어떠셨나요?</h1>
 내용
<div class="review_contents">
	<div class="warning_msg">
		5자 이상으로 작성해 주세요.
	</div>
	<textarea class="review_textarea w-100"></textarea>
</div>
<div class="">
	<label for="exampleFormControlInput1" class="form-label">이미지</label>
	<input type="text" class="form-control" id="exampleFormControlInput1" placeholder="이미지"/>
</div>
<style>
  .rating .rate_radio + label {
    position: relative;
    display: inline-block;
    margin-left: -4px;
    z-index: 10;
    width: 60px;
    height: 60px;
    background-image: url('./image/starrate.png');
    background-repeat: no-repeat;
    background-size: 60px 60px;
    cursor: pointer;
    background-color: #f0f0f0;
}
.rating .rate_radio:checked + label {
    background-color: #ff8;
}
.wrap{
  max-width: 480px;
  margin: 0 auto;
  background-color: #fff;
  height: 100%;
  padding: 20px;
  box-sizing: border-box;
}
.rating .rate_radio {
  position: relative;
  display: inline-block;
  z-index: 20;
  opacity: 0.001;
  width: 60px;
  height: 60px;
  background-color: #fff;
  cursor: pointer;
  vertical-align: top;
  display: none;
}
.rating .rate_radio + label {
  position: relative;
  display: inline-block;
  margin-left: -4px;
  z-index: 10;
  width: 60px;
  height: 60px;
  background-image: url('./image/starrate.png');
  background-repeat: no-repeat;
  background-size: 60px 60px;
  cursor: pointer;
  background-color: #f0f0f0;
}
.rating .rate_radio:checked + label {
  background-color: #ff8;
}
.warning_msg {
  display: none;
  position: relative;
  text-align: center;
  background: #ffffff;
  line-height: 26px;
  width: 100%;
  color: red;
  padding: 10px;
  box-sizing: border-box;
  border: 1px solid #e0e0e0;
}
</style>
<div class="wrap">
	<h1>점수</h1>
	<form name="reviewform" class="reviewform" method="post" action="/save">
		<input type="hidden" name="rate" id="rate" value="0"/>
		<div class="review_rating">
			<div class="warning_msg">
				별점을 선택해 주세요.
			</div>
			<div class="rating">
				<input type="checkbox" name="rating" id="rating1" value="1" class="rate_radio" title="1점">
				<label for="rating1"></label>
				<input type="checkbox" name="rating" id="rating2" value="2" class="rate_radio" title="2점">
				<label for="rating2"></label>
				<input type="checkbox" name="rating" id="rating3" value="3" class="rate_radio" title="3점">
				<label for="rating3"></label>
				<input type="checkbox" name="rating" id="rating4" value="4" class="rate_radio" title="4점">
				<label for="rating4"></label>
				<input type="checkbox" name="rating" id="rating5" value="5" class="rate_radio" title="5점">
				<label for="rating5"></label>
			</div>
		</div>
		<div class="cmd">
			<input type="button" name="save" id="save" value="취소">
			<input type="button" name="save" id="save" value="작성">
		</div>
	</form>
</div>
<script>
function Rating(){};
Rating.prototype.rate = 0;
Rating.prototype.setRate = function(newrate){
    this.rate = newrate;
    let items = document.querySelectorAll('.rate_radio');
    items.forEach(function(item, idx){
        if(idx < newrate){
            item.checked = true;
        }else{
            item.checked = false;
        }
    });
}
let rating = new Rating();
document.addEventListener('DOMContentLoaded', function(){
  document.querySelector('.rating').addEventListener('click',function(e){
      let elem = e.target;
      if(elem.classList.contains('rate_radio')){
          rating.setRate(parseInt(elem.value));
      }
  })
});
document.querySelector('.review_textarea').addEventListener('keydown',function(){
  let review = document.querySelector('.review_textarea');
  let lengthCheckEx = /^.{400,}$/;
  if(lengthCheckEx.test(review.value)){
      review.value = review.value.substr(0,400);
  }
});
document.querySelector('#save').addEventListener('click', function(e){
  if(rating.rate == 0){
      rating.showMessage('rate');
      return false;
  }
  if(document.querySelector('.review_textarea').value.length < 5){
      rating.showMessage('review');
      return false;
  }
});
Rating.prototype.showMessage = function(type){
  switch(type){
      case 'rate':
          document.querySelector('.review_rating .warning_msg').style.display = 'block';
          setTimeout(function(){
              document.querySelector('.review_rating .warning_msg').style.display = 'none';
          },1000);            
          break;
      case 'review':
          document.querySelector('.review_contents .warning_msg').style.display = 'block';
          setTimeout(function(){
              document.querySelector('.review_contents .warning_msg').style.display = 'none';
          },1000);    
          break;
  }
}
</script>
{% block js %}{% endblock js %} {% endblock %}